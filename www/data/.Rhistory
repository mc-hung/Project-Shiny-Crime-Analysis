install.packages("mvoutlier")
remove.packages("mvoutlier")
install.packages("mvoutlier")
install.packages("mvoutlier", repo = 'https://mac.R-project.org')
library(mvoutlier)
install.packages("robustbase")
install.packages("robustbase", type="binary")
install.packages("robustbase", repo = 'https://mac.R-project.org')
install.packages("MVN")
install.packages("mvoutlier")
install.packages("mvoutlier")
library(mvoutlier)
ppct <- read.table('~/Desktop/Tableau_R_Analytics/Chapter04/ProfitData.xlsx')
ppct <- read.table('~/Desktop/Tableau_R_Analytics/Chapter04/ProfitData.csv')
ppct <- read.table('~/Desktop/Tableau_R_Analytics/Chapter04/ProfitData.csv', sep=',', header=T)
outliers <- sign2(cbind(ppct$wfinal01, ppct$ProfitPct))
outliers
library(mvoutlier)
library(Rserve)
Rserve(args='--no-save')
library(mvoutlier)
knitr::opts_chunk$set(echo = TRUE)
read.table("~/Desktop/communities.data", sep=",", header=TRUE)
read.csv("~\Desktop\crimedata.csv")
read.csv("~/Desktop/crimedata.csv")
library(tidyverse)
read_csv("~/Desktop/crimedata.csv")
setwd("~/Desktop")
library(tidyverse)
read_csv("crimedata.csv")
library(tidyverse)
read_csv("crimedata.csv", header=TRUE)
library(tidyverse)
read_csv("crimedata.csv")
library(tidyverse)
read_csv("crimedata.csv",fileEncoding="UCS-2LE")
library(tidyverse)
read_csv("crimedata.csv",fileEncoding="latin1")
library(tidyverse)
read.csv("crimedata.csv",fileEncoding="latin1")
library(tidyverse)
#read.csv("crimedata.csv",fileEncoding="latin1")
iris.uci <- read.csv(url("http://archive.ics.uci.edu/ml/machine-learning-databases/communities//communities.data"),
header=TRUE)
library(tidyverse)
#read.csv("crimedata.csv",fileEncoding="latin1")
iris.uci <- read.csv(url("http://archive.ics.uci.edu/ml/machine-learning-databases/communities//communities.data"),
header=TRUE)
iris.uci
library(tidyverse)
#read.csv("crimedata.csv",fileEncoding="latin1")
iris.uci <- read.csv(url("http://archive.ics.uci.edu/ml/machine-learning-databases/communities//communities.data"),
header=FALSE)
iris.uci
library(tidyverse)
read.csv("crimedata.csv",fileEncoding="latin1")
#iris.uci <- read.csv(url("http://archive.ics.uci.edu/ml/machine-learning-databases/communities//communities.data"),header=FALSE)
#iris.uci
library(tidyverse)
dataset <- read.csv("crimedata.csv",fileEncoding="latin1")
#iris.uci <- read.csv(url("http://archive.ics.uci.edu/ml/machine-learning-databases/communities//communities.data"),header=FALSE)
#iris.uci
View(dataset)
names(dataset)[1] <- "community"
dataset
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,vars]
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[vars,]
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[vars,]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,vars]
View(dataset1)
View(dataset)
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2)]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c("community","state")]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,16)]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade", "PctNotHSGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,17,18,25,27,28,29,30,31,32)]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,vars]
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,17,18,25,27,28,29,30,31,32,34,35,36,37,38,39)]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,17,18,25,27,28,29,30,31,32,34,35,36,37,38,39,48,66,67)]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,17,18,25,27,28,29,30,31,32,34,35,36,37,38,39,48,66,67,69,73,74,75,78)]
dataset1
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,17,18,25,27,28,29,30,31,32,34,35,36,37,38,39,48,66,67,69,73,74,75,78,97,98,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146)]
dataset1
omit.na(dataset1)
naniar::replace_with_na("?" -> NA)
install.packages("naniar")
naniar::replace_with_na("?" -> NA)
install.packages("naniar")
replace_with_na("?" -> NA)
install.packages("naniar")
knitr::opts_chunk$set(echo = TRUE)
#install.packages("naniar")
replace_with_na("?" -> NA)
#install.packages("naniar")
dataset1<- replace_with_na("?" -> NA)
#install.packages("naniar")
dataset1[dataset1 == "?"] <- NA
dataset1
#install.packages("naniar")
dataset1[dataset1 == "?"] <- NA
na.omit(dataset1)
sub_edu <- dataset1[,c("community", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
sub_edu
sub_edu <- dataset1[,c("community", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[2] <- "<=9thGrade"
names(sub_edu)[3] <- "<=HighSchool"
names(sub_edu)[4] <- ">=BS"
sub_edu
sub_edu <- dataset1[,c("community", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[2] <- "<=9thGrade"
names(sub_edu)[3] <- "<=HighSchool"
names(sub_edu)[4] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[2] <- "<=9thGrade"
names(sub_edu)[3] <- "<=HighSchool"
names(sub_edu)[4] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
#install.packages("naniar")
dataset1[dataset1 == "?"] <- NA
na.omit(dataset1)
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[2] <- "<=9thGrade"
names(sub_edu)[3] <- "<=HighSchool"
names(sub_edu)[4] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
#install.packages("naniar")
dataset1[dataset1 == "?"] <- NA
dataset1<-na.omit(dataset1)
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[2] <- "<=9thGrade"
names(sub_edu)[3] <- "<=HighSchool"
names(sub_edu)[4] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
unique(dataset1$community)
count(unique(dataset1$community))
length(unique(dataset1$community))
dataset1 %>%
group_by("community","state") %>%
summarise(n())
#install.packages("naniar")
dataset1[dataset1 == "?"] <- NA
dataset1<-na.omit(dataset1)
dataset1
dataset1$communityInState <- paste(dataset1$community, "-", dataset1$state)
dataset1
length(unique(dataset1$communityInState))
library(shiny); runApp('IE6600/hw5Mei-ChunHung.R')
View(dataset)
View(dataset)
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,17,18,25,27,28,29,30,31,32,34,35,36,37,38,39,48,66,67,69,73,74,75,78,97,98,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146, 147)]
dataset1
#install.packages("naniar")
dataset1[dataset1 == "?"] <- NA
dataset1<-na.omit(dataset1)
dataset1
runApp('IE6600/hw5Mei-ChunHung.R')
state.abb[grep(c("Maine", "Massachusetts", "Rhode Island", "Connecticut", "New Hampshire", "Vermont", "New York", "Pennsylvania", "New Jersey", "Delaware", "Maryland"),state.name)]
Northeast <- c("ME", "MA", "RI", "CT", "NH", "VA", "NY", "PA", "NJ", "DE", "MD")
Southeast <- c("WV", "VA", "KY", "TN", "NC", "SC", "GA", "AL", "MS", "AR", "LA", "FL")
Midwest <- c("OH", "IN", "MI", "IL", "MO", "WI", "MN", "IA", "KS", "NE", "SD", "ND")
Southwest <- c("TX", "OK", "NM", "AZ")
West <- c("CO", "WY", "MT", "ID", "WA", "OR", "UT", "NV", "CA", "AK", "HI")
dataset1 %<%
mutate(dataset1, Region =
ifelse(state %in% Northeast,"Northeast",
ifelse(state %in% Southeast,"Southeast",
ifelse(state %in% Midwest,"Midwest",
ifelse(state %in% Southwest,"Southwest","Obesity")))))
dataset1 %>%
mutate(dataset1, Region =
ifelse(state %in% Northeast,"Northeast",
ifelse(state %in% Southeast,"Southeast",
ifelse(state %in% Midwest,"Midwest",
ifelse(state %in% Southwest,"Southwest","West")))))
dataset1 %>%
mutate(dataset1, Region =
ifelse(state %in% Northeast,"Northeast",
ifelse(state %in% Southeast,"Southeast",
ifelse(state %in% Midwest,"Midwest",
ifelse(state %in% Southwest,"Southwest","West")))))
dataset1 %>%
mutate(dataset1, Region =
ifelse(state == Northeast,"Northeast",
ifelse(state %in% Southeast,"Southeast",
ifelse(state %in% Midwest,"Midwest",
ifelse(state %in% Southwest,"Southwest","West")))))
dataset1 <- mutate(dataset1, Region =
ifelse(state %in% Northeast,"Northeast",
ifelse(state %in% Southeast,"Southeast",
ifelse(state %in% Midwest,"Midwest",
ifelse(state %in% Southwest,"Southwest", "West")))))
dataset1 <- mutate(dataset1, Region =
ifelse(state %in% Northeast,"Northeast",
ifelse(state %in% Southeast,"Southeast",
ifelse(state %in% Midwest,"Midwest",
ifelse(state %in% Southwest,"Southwest", "West")))))
dataset1
dataset1 <- mutate(dataset1, communityInState = paste(dataset1$community, "-", dataset1$state))
dataset1
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[2] <- "<=9thGrade"
names(sub_edu)[3] <- "<=HighSchool"
names(sub_edu)[4] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[2] <- "<=9thGrade"
names(sub_edu)[3] <- "<=HighSchool"
names(sub_edu)[4] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "Population")]
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
unique(sub_set$EducationLevel)
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
unique(sub_edu$EducationLevel)
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu$EducationLevel
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
unique(sub_edu$EducationLevel)
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
sub_edu
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
round(sub_edu$NumberOfPeople, 2)
sub_edu
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
floor(sub_edu$NumberOfPeople)
sub_edu
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
sub_edu$NumberOfPeople <- floor(sub_edu$NumberOfPeople)
sub_edu
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
sub_edu$NumberOfPeople <- round(sub_edu$NumberOfPeople,0)
sub_edu
View(dataset1)
dataset1 %>%
unite(new, community, state)
d <-
mutate(dataset1, unite(new, community, state))
d <- mutate(dataset1, new=unite(new, community, state))
d <- mutate(dataset1, dataset1%>%unite(new, community, state))
rm(dataset1)
names(dataset)[1] <- "community"
vars <- c("community","state","fold","population","householdsize","racepctblack","racePctWhite","racePctAsian", "racePctHisp", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up", "pctUrban", "medIncome", "medFamInc", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "OtherPerCap", "HisPerCap","PctPopUnderPov", "PctLess9thGrade","PctNotHSGrad","PctBSorMore","PctUnemployed","PctEmploy","PersPerFam","PctSpeakEnglOnly","PctNotSpeakEnglWell","PctLargHouseOccup","PctPersOwnOccup","PctPersDenseHous","PctHousLess3BR","PctHousOccup","NumInShelters","NumStreet","murders","murdPerPop","rapes","rapesPerPop","robberies","robbbPerPop","assaults","assaultPerPop","burglaries","burglPerPop","larcenies","larcPerPop","autoTheft","autoTheftPerPop","arsons","arsonsPerPop","ViolentCrimesPerPop")
dataset1 <- dataset[,c(1,2,5,6,7,8,9,10,11,12,13,14,15,17,18,25,27,28,29,30,31,32,34,35,36,37,38,39,48,66,67,69,73,74,75,78,97,98,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146, 147)]
dataset1
#install.packages("naniar")
dataset1[dataset1 == "?"] <- NA
dataset1<-na.omit(dataset1)
dataset1
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
#add unique community
dataset1 <- mutate(dataset1, communityInState = paste(dataset1$community, "-", dataset1$state))
dataset1
Northeast <- c("ME", "MA", "RI", "CT", "NH", "VA", "NY", "PA", "NJ", "DE", "MD")
Southeast <- c("WV", "VA", "KY", "TN", "NC", "SC", "GA", "AL", "MS", "AR", "LA", "FL")
Midwest <- c("OH", "IN", "MI", "IL", "MO", "WI", "MN", "IA", "KS", "NE", "SD", "ND")
Southwest <- c("TX", "OK", "NM", "AZ")
West <- c("CO", "WY", "MT", "ID", "WA", "OR", "UT", "NV", "CA", "AK", "HI")
#add region
dataset1 <- mutate(dataset1, Region =
ifelse(state %in% Northeast,"Northeast",
ifelse(state %in% Southeast,"Southeast",
ifelse(state %in% Midwest,"Midwest",
ifelse(state %in% Southwest,"Southwest", "West")))))
dataset1
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
sub_edu$NumberOfPeople <- round(sub_edu$NumberOfPeople,0)
sub_edu
library(tidyverse)
library(tidyr)
sub_edu <- dataset1[,c("community","Region", "PctLess9thGrade","PctNotHSGrad","PctBSorMore", "population")]
names(sub_edu)[3] <- "<=9thGrade"
names(sub_edu)[4] <- "<=HighSchool"
names(sub_edu)[5] <- ">=BS"
sub_edu <- sub_edu %>%
gather("<=9thGrade","<=HighSchool",">=BS",key="EducationLevel", value="PercentageOfPeople")
sub_edu <- mutate(sub_edu, NumberOfPeople = population * PercentageOfPeople / 100)
sub_edu$NumberOfPeople <- round(sub_edu$NumberOfPeople,0)
sub_edu
head(arrange(dataset1, desc(ViolentCrimesPerPop)),n=20)
head(arrange(dataset1, desc(ViolentCrimesPerPop)),n=20)[,c(1,2,54,55)]
head(arrange(dataset1, desc(ViolentCrimesPerPop)),n=20)[,c(1,2,55,56)]
unique(dataset1[,1])
unique(dataset1[1,])
unique(dataset1)
names(dataset1)
runApp('IE6600/hw5Mei-ChunHung.R')
sub_race <- dataset1[,c("community", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "HispPerCap" )]
names(sub_race)[2] <- "Caucasians"
names(sub_race)[3] <- "African Americans"
names(sub_race)[4] <- "Native Americans"
names(sub_race)[5] <- "Asian heritage"
names(sub_race)[6] <- "Hispanic heritage"
sub_race %>%
gather("Caucasians","African Americans", "Native Americans", "Asian heritage",
"Hispanic heritage",key="Race",value="PercapitaIncome ")
sub_race
sub_race <- dataset1[,c("community", "whitePerCap", "blackPerCap", "indianPerCap", "AsianPerCap", "HispPerCap" )]
names(sub_race)[2] <- "Caucasians"
names(sub_race)[3] <- "African Americans"
names(sub_race)[4] <- "Native Americans"
names(sub_race)[5] <- "Asian heritage"
names(sub_race)[6] <- "Hispanic heritage"
sub_race<-
sub_race %>%
gather("Caucasians","African Americans", "Native Americans", "Asian heritage",
"Hispanic heritage",key="Race",value="PercapitaIncome ")
sub_race
age_sub <- dataset1[,c("community","agePct12t21", "agePct12t29", "agePct16t24", "agePct65up","ViolentCrimesPerPop","nonViolPerPop")]
names(age_sub)[2] <- "age12to21"
names(age_sub)[3] <- "age12to29"
names(age_sub)[4] <- "age16to24"
names(age_sub)[5] <- "age65up"
age_sub <- age_sub %>%
gather("age12to21", "age12to29","age16to24","age65up",key="agegroup", value="percentage")
age_sub
age_sub <- dataset1[,c("community","agePct12t21", "agePct12t29", "agePct16t24", "agePct65up","population","Region")]
names(age_sub)[2] <- "age12to21"
names(age_sub)[3] <- "age12to29"
names(age_sub)[4] <- "age16to24"
names(age_sub)[5] <- "age65up"
age_sub <- age_sub %>%
gather("age12to21", "age12to29","age16to24","age65up",key="agegroup", value="percentage")
age_sub <- mutate(age_sub, PopofGroup = population * percentage / 100)
age_sub$PopofGroup <- round(age_sub$PopofGroup,0)
age_sub
age_sub <- dataset1[,c("community","agePct12t21", "agePct12t29", "agePct16t24", "agePct65up","population","Region")]
names(age_sub)[2] <- "age12to21"
names(age_sub)[3] <- "age12to29"
names(age_sub)[4] <- "age16to24"
names(age_sub)[5] <- "age65up"
age_sub <- age_sub %>%
gather("age12to21", "age12to29","age16to24","age65up",key="agegroup", value="percentage")
age_sub <- mutate(age_sub, PopofGroup = population * percentage / 100)
age_sub$PopofGroup <- round(age_sub$PopofGroup,0)
age_sub
library(shiny); runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
setwd("~/Desktop/Team1Shiny/www")
runApp('~/Desktop/Team1Shiny/Team1Shiny.R')
runApp('~/Desktop/Team1Shiny/Team1Shiny.R')
runApp('~/Desktop/Team1Shiny/Team1Shiny.R')
runApp('~/Desktop/Team1Shiny/Team1Shiny.R')
runApp('~/Desktop/Team1Shiny/Team1Shiny.R')
runApp('~/Desktop/Team1Shiny/Team1Shiny.R')
setwd("~/Desktop")
runApp('Team1Shiny/Team1Shiny.R')
runApp('Team1Shiny/Team1Shiny.R')
setwd("~/Desktop/Team1Shiny/www/data")
runApp('~/Desktop/Team1Shiny/Team1Shiny.R')
